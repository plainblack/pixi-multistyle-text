<!DOCTYPE html>
<html>
  <head>
    <title>Pixi MultiStyle Text Demo</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css?family=Inconsolata"
      rel="stylesheet"
    />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.2.0/pixi.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
    <script src="../dist/pixi-multistyle-text.umd.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
    </script>
  </head>

  <body>
    <h1>Pixi Multistyle Text Demo</h1>
    <main>
      <script>
        var MultiStyleText = pixiMultistyleText.MultiStyleText;
        var RichText = pixiMultistyleText.RichText;

        function appendPixiRendererToId(
          id,
          width = 600,
          height = 600,
          backgroundColor = 0x333333
        ) {
          PIXI.settings.RESOLUTION = 2;
          let renderer = PIXI.autoDetectRenderer({
            width,
            height,
          });
          renderer.backgroundColor = backgroundColor;
          document.getElementById(id).appendChild(renderer.view);

          return renderer;
        }

        function createPixiRendererAndStage(id) {
          const renderer = appendPixiRendererToId(id);
          const stage = new PIXI.Sprite();
          const render = () => renderer.render(stage);

          return [renderer, stage, render];
        }

        function createDemo(children, id) {
          const [renderer, stage] = createPixiRendererAndStage(id);

          children.forEach((child) => {
            // child.x = 300 - child.width / 2;
            child.x = 30;
            child.y = 30;
            stage.addChild(child);
          });
          const [multistyle, richtext] = children;
          multistyle.alpha = 0.5;
          multistyle.visible = false;

          const tf = new PIXI.Text(
            "synthesize Senior Directives extranet Refined Delectus quisquam rerum doloremque quo veniam ut optio nesciunt dicta. Est dolorum asperiores. Aperiam rem et aut rerum dolorem. Numquam reprehenderit sunt. Cum illum corrupti.",
            {
              align: "left",
              wordWrap: false,
              wordWrapWidth: 500,
              fill: "#FF00FF",
            }
          );
          tf.x = children[1].x;
          tf.y = children[1].y;
          tf.visible = false;
          stage.addChild(tf);

          renderer.render(stage);

          return [renderer, stage];
        }

        // For testing purposes, temporarily replace the code that creates
        // text fields to create two of them to compare against each other.
        function createComparisonText(text, styles) {
          return [new MultiStyleText(text, styles), new RichText(text, styles)];
        }
      </script>
      <div class="example">
        <div class="code">
          <h2>Vertical Alignment</h2>
          <pre><code class="js">let valign = new MultiStyleText(&quot;You can use &lt;code&gt;valign&lt;/code&gt; &lt;top&gt;to&lt;/top&gt; &lt;middle&gt;control&lt;/middle&gt; &lt;baseline&gt;the&lt;/baseline&gt; &lt;bottom&gt;vertical&lt;/bottom&gt; &lt;custom1&gt;alignment&lt;/custom1&gt; &lt;custom2&gt;of&lt;/custom2&gt; &lt;custom3&gt;text&lt;/custom3&gt;.&quot;,
{
&quot;default&quot;: {
fontFamily: &quot;Arial&quot;,
fontSize: &quot;24px&quot;,
fill: &quot;#cccccc&quot;
},
&quot;code&quot;: {
fontFamily: &quot;Inconsolata&quot;,
fontSize: &quot;36px&quot;,
fill: &quot;#ff8888&quot;
},
&quot;top&quot;: { fontSize: &quot;14px&quot;, valign: &quot;top&quot; },
&quot;middle&quot;: { fontSize: &quot;14px&quot;, valign: &quot;middle&quot; },
&quot;bottom&quot;: { fontSize: &quot;14px&quot;, valign: &quot;bottom&quot; },
&quot;baseline&quot;: { fontSize: &quot;14px&quot;, valign: &quot;baseline&quot; },
&quot;custom1&quot;: { fontSize: &quot;14px&quot;, valign: 5 },
&quot;custom2&quot;: { fontSize: &quot;14px&quot;, valign: -70 },
&quot;custom3&quot;: { fontSize: &quot;14px&quot;, valign: 25 }
});</code></pre>
        </div>
        <div class="pixi" id="valign">
          <script>
            // Vertical Alignment
            const valignStyle = {
              default: {
                fontFamily: "Arial",
                fontSize: "24px",
                fill: "#cccccc",
                align: "left",
                valign: "baseline",
              },
              code: {
                fontFamily: "Courier",
                fontSize: "36px",
                fill: "#ff8888",
              },
              small: { fontSize: "14px" },
              top: { valign: "top" },
              middle: { valign: "middle" },
              bottom: { valign: "bottom" },
              baseline: { valign: "baseline" },
              custom1: { fontSize: "14px", valign: 5 },
              custom2: { fontSize: "14px", valign: -70 },
              custom3: { fontSize: "14px", valign: 25 },
            };
            let valign = createComparisonText(
              `
<top><code>Top</code> <small>Vertical</small>Alignment.</top>

<middle><code>Middle</code> <small>Vertical</small>Alignment.</middle>

<bottom><code>Bottom</code> <small>Vertical</small>Alignment.</bottom>

<baseline><code>Baseline</code> <small>Vertical</small>Alignment.</baseline>

You can use <code>valign</code> <top>to</top> <middle>control</middle> <baseline>vertical</baseline> <bottom>alignment</bottom> <custom1>with</custom1> <custom2>arbitrary</custom2> <custom3>values</custom3>.`,
              valignStyle
            );
            createDemo(valign, "valign");
          </script>
        </div>
      </div>
      <div class="example">
        <div class="code">
          <h2>Alignment</h2>
          <pre><code class="js">
          </code></pre>
        </div>
        <div class="pixi" id="align">
          <script>
            // Alignment.
            const str = `You can align left, right, center or justify.\nEt veniam nemo sunt ab facilis voluptatem voluptas est debitis.`;
            const style = {
              default: {
                align: "left",
                fill: "teal",
                wordWrapWidth: 250,
              },
              b: {
                fontWeight: "700",
                fill: "white",
              },
            };
            const opt = { debug: true };

            let left = createComparisonText(
              str.replace("left", "<b>left</b>"),
              style,
              {}
            );
            let right = new RichText(
              str.replace("right", "<b>right</b>"),
              {
                ...style,
                default: {
                  align: "right",
                  fill: "orange",
                  wordWrapWidth: 250,
                },
              },
              opt
            );
            right.x = 330;
            right.y = 30;

            let center = new RichText(
              str.replace("center", "<b>center</b>"),
              {
                ...style,
                default: {
                  align: "center",
                  fill: "yellow",
                  wordWrapWidth: 250,
                },
              },
              opt
            );
            center.x = 30;
            center.y = 330;

            let justify = new RichText(
              str.replace("justify", "<b>justify</b>"),
              {
                ...style,
                default: {
                  align: "justify",
                  fill: "pink",
                  wordWrapWidth: 250,
                },
              },
              opt
            );
            justify.x = 330;
            justify.y = 330;

            const [r, stage] = createDemo(left, "align");
            stage.addChild(right);
            stage.addChild(center);
            stage.addChild(justify);
            r.render(stage);
          </script>
        </div>
      </div>
      <div class="example">
        <div class="code">
          <h2>Attributes</h2>
          <pre><code class="js">
          </code></pre>
        </div>
        <div class="pixi" id="attributes">
          <script>
            // Basics
            let attributes = createComparisonText(
              `You can add <em>attributes</em> to your tags!\nThey will <em fontStyle="italic">overwrite</em> the <em fill="#FF8822">values</em><br></br>for any existing <em fontFamily="Courier" fill="#FFFF00" fontWeight="400">tag styles</em>.`,
              {
                default: {
                  fontFamily: "Arial",
                  fontSize: "24px",
                  fill: "#cccccc",
                  align: "left",
                },
                em: {
                  fill: "#4488FF",
                  fontWeight: 700,
                },
              }
            );

            createDemo(attributes, "attributes");
          </script>
        </div>
      </div>

      <div class="example">
        <div class="code">
          <h2>Basics</h2>
          <pre><code class="js">let text = new MultiStyleText(&quot;Let's make some &lt;ml&gt;multiline&lt;/ml&gt;\nand &lt;ms&gt;multistyle&lt;/ms&gt; text for\n&lt;pixi&gt;Pixi.js!&lt;/pixi&gt;&quot;,
          {
            &quot;default&quot;: {
              fontFamily: &quot;Arial&quot;,
              fontSize: &quot;24px&quot;,
              fill: &quot;#cccccc&quot;,
              align: &quot;center&quot;
            },
            &quot;ml&quot;: {
              fontStyle: &quot;italic&quot;,
              fill: &quot;#ff8888&quot;
            },
            &quot;ms&quot;: {
              fontStyle: &quot;italic&quot;,
              fill: &quot;#4488ff&quot;
            },
            &quot;pixi&quot;: {
              fontSize: &quot;64px&quot;,
              fill: &quot;#efefef&quot;
            }
          });</code></pre>
        </div>

        <div class="pixi" id="basic">
          <script>
            // Basics
            let text = createComparisonText(
              "Let's make some <ml>multiline</ml>\nand <ms>multistyle</ms> text for\n<pixi>Pixi.js!</pixi>",
              {
                default: {
                  fontFamily: "Arial",
                  fontSize: "24px",
                  fill: "#cccccc",
                  align: "center",
                },
                ml: {
                  fontStyle: "italic",
                  fill: "#ff8888",
                },
                ms: {
                  fontWeight: "bold",
                  fill: "#4488ff",
                },
                pixi: {
                  fontSize: "64px",
                  fill: "#efefef",
                },
              }
            );

            createDemo(text, "basic");
          </script>
        </div>
      </div>

      <div class="example">
        <div class="code">
          <h2>Tag Styles</h2>
          <pre><code class="js">let text = new MultiStyleText(&quot;Let's make some [b]bold[/b]\n [color=yellow][i]multistyle[/i][/color] [size=40]bbcode[/size] [outline=purple]tags[/outline] text for \n[spacing=10]Pixi.js![/spacing]&quot;,
{
	&quot;default&quot;: {
		tagStyle: &quot;bbcode&quot;, //bbcode and xml (default) supported..
		fill: &quot;#cccccc&quot;,
		align: &quot;center&quot;
	},
});</code></pre>
        </div>
        <div class="pixi" id="bbcode">
          <script>
            // Tag Styles
            let bbcode = createComparisonText(
              "Let's make some [b]bold[/b]\n [color=yellow][i]multistyle[/i][/color] [size=40]bbcode[/size] [outline=purple]tags[/outline] text for \n[spacing=10]Pixi.js![/spacing]",
              {
                default: {
                  tagStyle: "bbcode",
                  fill: "#cccccc",
                  align: "center",
                },
              }
            );
            bbcode[1].text = "bbcode not supported!";
            createDemo(bbcode, "bbcode");
          </script>
        </div>
      </div>
      <div class="example">
        <div class="code">
          <h2>Nesting Tags</h2>
          <pre><code class="js">let nested = new MultiStyleText(&quot;You can &lt;outline&gt;nest &lt;b&gt;tags &lt;red&gt;as &lt;i&gt;deeply &lt;thicker&gt;as &lt;shadow&gt;you'd &lt;large&gt;like&lt;/large&gt;&lt;/shadow&gt;&lt;/thicker&gt;&lt;/i&gt;&lt;/red&gt;&lt;/b&gt;&lt;/outline&gt;&quot;,
{
	&quot;default&quot;: {
		fontFamily: &quot;Arial&quot;,
		fontSize: &quot;24px&quot;,
		fill: &quot;#cccccc&quot;
	},
	&quot;outline&quot;: { stroke: &quot;black&quot;, strokeThickness: 2 },
	&quot;b&quot;: { fontWeight: 700 },
	&quot;red&quot;: { fill: &quot;#ff8888&quot; },
	&quot;i&quot;: { fontStyle: &quot;italic&quot; },
	&quot;thicker&quot;: { strokeThickness: 6 },
	&quot;shadow&quot;: { dropShadow: true, dropShadowColor: &quot;#888888&quot; },
	&quot;large&quot;: { fontSize: &quot;36px&quot; }
});</code></pre>
        </div>
        <div class="pixi" id="nested">
          <script>
            // Nesting Tags
            let nested = createComparisonText(
              "You can <outline>nest <b>tags <red>as <i>deeply <thicker>as <shadow>you'd <large>like</large></shadow></thicker></i></red></b></outline>",
              {
                default: {
                  fontFamily: "Arial",
                  fontSize: "24px",
                  fill: "#cccccc",
                },
                outline: { stroke: "black", strokeThickness: 2 },
                b: { fontWeight: 700 },
                red: { fill: "#ff8888" },
                i: { fontStyle: "italic" },
                thicker: { strokeThickness: 6 },
                shadow: { dropShadow: true, dropShadowColor: "#888888" },
                large: { fontSize: "36px" },
              }
            );
            createDemo(nested, "nested");
          </script>
        </div>
      </div>

      <div class="example">
        <div class="code">
          <h2>Spacing</h2>
          <pre><code class="js">
let lineSpacing = createComparisonText("It is entirely possible to adjust the line height on your text so that the spaces between your lines of text can be so wide that you could run all the traffic in Los Angeles through them. Note that it can only be set on the default style.",
{
"default": {
fontFamily: "Arial",
fontSize: "24px",
fill: "#cccccc",
lineSpacing: 20,
letterSpacing: 10,
wordWrap: true,
wordWrapWidth: 500,
},
});

lineSpacing.x = 300 - lineSpacing.width / 2;
lineSpacing.y = 3530;
stage.addChild(lineSpacing);
</code></pre>
        </div>
        <div class="pixi" id="spacing">
          <script>
            // Spacing
            let spacing = createComparisonText(
              "You can set line and letter spacing to give your text some drama. Note that lineSpacing can only be set on the default style.",
              {
                default: {
                  fontFamily: "Arial",
                  fontSize: "24px",
                  fill: "#cccccc",
                  lineSpacing: 10,
                  letterSpacing: 10,
                  wordWrap: true,
                  wordWrapWidth: 500,
                },
              }
            );

            createDemo(spacing, "spacing");
          </script>
        </div>
      </div>
      <div class="example">
        <div class="code">
          <h2>Wrapping and Alignment</h2>
          <pre><code class="js">let wrapping = new MultiStyleText(&quot;Global word wrap and alignment properties are controlled by the \&quot;default\&quot; style, and can't be overridden by other styles.&quot;,
{
	&quot;default&quot;: {
		fontFamily: &quot;Arial&quot;,
		fontSize: &quot;24px&quot;,
		fill: &quot;#cccccc&quot;,
		wordWrap: true,
		wordWrapWidth: 150,
		align: &quot;right&quot;
	}
});</code></pre>
        </div>
        <div class="pixi" id="wrapping">
          <script>
            // Wrapping and Alignment
            let wrapping = createComparisonText(
              'Global word wrap and alignment properties are controlled by the "default" style, and can\'t be overridden by other styles.',
              {
                default: {
                  fontFamily: "Arial",
                  fontSize: "24px",
                  fill: "#cccccc",
                  wordWrap: true,
                  wordWrapWidth: 150,
                  align: "right",
                },
              }
            );
            createDemo(wrapping, "wrapping");
          </script>
        </div>
      </div>
      <div class="example">
        <div class="code">
          <h2>Wrapping and Alignment II</h2>
          <pre><code class="js">// breakWords allows newlines to be inserted anywhere - not just at whitespaces.
// This is useful for some languages like Chinese.

let wrapping2 = new MultiStyleText(&quot;全局设置的&lt;blue&gt;对齐&lt;/blue&gt;属性由「默认」来&lt;big&gt;控制&lt;/big&gt;。而且不能被&lt;blue&gt;别的样式&lt;/blue&gt;所&lt;red&gt;覆盖&lt;/red&gt;。&quot;,
{
	&quot;default&quot;: {
		fontFamily: &quot;Arial&quot;,
		fontSize: &quot;16px&quot;,
		fill: &quot;#cccccc&quot;,
		wordWrap: true,
		wordWrapWidth: 250,
		breakWords: true,
	},
	&quot;blue&quot;: { fill: 0x4488ff, stroke: 0x2244cc, fontSize: &quot;24px&quot; },
	&quot;red&quot;: { fill: 0xff8888, stroke: 0xcc4444 },
	&quot;big&quot;: { fill: 0x88ff88, stroke: 0x44cc44, fontSize: &quot;36px&quot; }
});</code></pre>
        </div>
        <div class="pixi" id="wrapping2">
          <script>
            // Wrapping and Alignment II
            let wrapping2 = createComparisonText(
              "全局设置的<blue>对齐</blue>属性由「默认」来<big>控制</big>。而且不能被<blue>别的样式</blue>所<red>覆盖</red>。",
              {
                default: {
                  fontFamily: "Arial",
                  fontSize: "16px",
                  fill: "#cccccc",
                  wordWrap: true,
                  wordWrapWidth: 250,
                  breakWords: true,
                },
                blue: { fill: 0x4488ff, stroke: 0x2244cc, fontSize: "24px" },
                red: { fill: 0xff8888, stroke: 0xcc4444 },
                big: { fill: 0x88ff88, stroke: 0x44cc44, fontSize: "36px" },
              }
            );
            createDemo(wrapping2, "wrapping2");
          </script>
        </div>
      </div>
      <div class="example">
        <div class="code">
          <h2>Debug Mode</h2>
          <pre><code class="js">MultiStyleText.debugOptions.spans.enabled = true;
MultiStyleText.debugOptions.objects.enabled = true;

let debug = new MultiStyleText(&quot;You can use &lt;code&gt;debug mode&lt;/code&gt; to help you figure out what your text is doing.  You can use &lt;blue&gt;global, &lt;/blue&gt;&lt;red&gt;static&lt;/red&gt; settings or &lt;no-debug&gt;override those with the &lt;code&gt;debug&lt;/code&gt; style option.&lt;/no-debug&gt;&quot;,
{
	&quot;default&quot;: {
		fontFamily: &quot;Arial&quot;,
		fontSize: &quot;24px&quot;,
		fill: &quot;#cccccc&quot;,
		wordWrap: true,
		wordWrapWidth: 500,
		debug: true,
	},
	&quot;code&quot;: {
		fontFamily: &quot;Inconsolata&quot;,
		fontSize: &quot;36px&quot;,
		fill: &quot;#ff8888&quot;
	},
	&quot;blue&quot;: { fill: 0x4488ff, stroke: 0x2244cc },
	&quot;red&quot;: { fill: 0xff8888, stroke: 0xcc4444 },
	&quot;no-debug&quot;: { debug: false }
});</code></pre>
        </div>
        <div class="pixi" id="debug">
          <script>
            // Debug Mode
            let debug = createComparisonText(
              "You can use <code>debug mode</code> to help you figure out what your text is doing.  You can use <blue>global, </blue><red>static</red> settings or <no-debug>override those with the <code>debug</code> style option.</no-debug>",
              {
                default: {
                  fontFamily: "Arial",
                  fontSize: "24px",
                  fill: "#cccccc",
                  wordWrap: true,
                  wordWrapWidth: 500,
                  debug: true,
                },
                code: {
                  fontFamily: "Inconsolata",
                  fontSize: "36px",
                  fill: "#ff8888",
                },
                blue: { fill: 0x4488ff, stroke: 0x2244cc },
                red: { fill: 0xff8888, stroke: 0xcc4444 },
                "no-debug": { debug: false },
              }
            );

            MultiStyleText.debugOptions.spans.enabled = true;
            MultiStyleText.debugOptions.objects.enabled = true;

            createDemo(debug, "debug");

            MultiStyleText.debugOptions.spans.enabled = false;
            MultiStyleText.debugOptions.objects.enabled = false;
          </script>
        </div>
      </div>
      <div class="example">
        <div class="code">
          <h2>Interaction Events</h2>
          <pre><code class="js">let interaction = new MultiStyleText(`If you enable &lt;link name=&quot;interaction&quot;&gt;interaction&lt;/link&gt;, you can get &lt;link name=&quot;information&quot;&gt;information&lt;/link&gt; about which &lt;link name=&quot;tag&quot;&gt;tag&lt;/link&gt; corresponded to the &lt;link name=&quot;event&quot;&gt;event&lt;/link&gt;.`,
{
	&quot;default&quot;: {
		fontFamily: &quot;Arial&quot;,
		fontSize: &quot;24px&quot;,
		fill: &quot;#cccccc&quot;,
		wordWrap: true,
		wordWrapWidth: 500,
	},
	&quot;link&quot;: {
		fill: 0x4488ff,
		fontStyle: &quot;italic&quot;
	}
});

interaction.interactive = true;

interaction.on(&quot;pointerdown&quot;, (e) =&gt; {
	if (e.targetTag.name === &quot;link&quot;) {
		alert(`You clicked on the link for &quot;${e.targetTag.properties.name}&quot;!`);
	}
});</code></pre>
        </div>
        <div class="pixi" id="interaction">
          <script>
            // Interaction Events
            let interaction = createComparisonText(
              `If you enable <link name="interaction">interaction</link>, you can get <link name="information">information</link> about which <link name="tag">tag</link> corresponded to the <link name="event">event</link>.`,
              {
                default: {
                  fontFamily: "Arial",
                  fontSize: "24px",
                  fill: "#cccccc",
                  wordWrap: true,
                  wordWrapWidth: 500,
                },
                link: {
                  fill: 0x4488ff,
                  fontStyle: "italic",
                },
              }
            );

            for (const text of interaction) {
              text.interactive = true;
              text.on("pointerdown", (e) => {
                if (e.targetTag !== undefined && e.targetTag.name === "link") {
                  alert(
                    `You clicked on the link for "${e.targetTag.properties.name}"!`
                  );
                }
              });
            }

            createDemo(interaction, "interaction");
          </script>
        </div>
      </div>
      <div class="example">
        <div class="code">
          <h2>Have Fun</h2>
          <pre><code class="js">let funStyles = {
	&quot;default&quot;: {
		fontFamily: &quot;Arial&quot;,
		fontSize: &quot;24px&quot;,
		fill: &quot;#cccccc&quot;,
		strokeThickness: 1,
		stroke: &quot;#aaaaaa&quot;,
		dropShadow: true,
		dropShadowBlur: 10,
		dropShadowDistance: 8,
		dropShadowAngle: 0
	},
	&quot;blue&quot;: { fill: 0x4488ff, stroke: 0x2244cc },
	&quot;red&quot;: { fill: 0xff8888, stroke: 0xcc4444 }
};

let fun = new MultiStyleText(&quot;Now have fun making some &lt;blue&gt;beautiful&lt;/blue&gt; &lt;red&gt;multistyle&lt;/red&gt; text!&quot;, funStyles);

function animate() {
	requestAnimationFrame(animate);
	// ...

	funStyles.default.dropShadowAngle += 0.02;
	funStyles.default.dropShadowBlur = Math.sin(funStyles.default.dropShadowAngle + Math.PI / 4) * 5 + 5;
	fun.styles = funStyles;
}

requestAnimationFrame(animate);</code></pre>
        </div>
        <div class="pixi" id="animated">
          <script>
            // Have Fun
            let funStyles = {
              default: {
                fontFamily: "Arial",
                fontSize: "24px",
                fill: "#cccccc",
                strokeThickness: 1,
                stroke: "#aaaaaa",
                dropShadow: true,
                dropShadowBlur: 10,
                dropShadowDistance: 8,
                dropShadowAngle: 0,
              },
              blue: { fill: 0x4488ff, stroke: 0x2244cc },
              red: { fill: 0xff8888, stroke: 0xcc4444 },
            };

            let animated = createComparisonText(
              "Now have fun making some <blue>beautiful</blue> <red>multistyle</red> text!",
              funStyles
            );

            const [renderer, animatedStage] = createDemo(animated, "animated");

            // Animate
            function animate() {
              requestAnimationFrame(animate);
              renderer.render(animatedStage);

              funStyles.default.dropShadowAngle += 0.02;
              funStyles.default.dropShadowBlur =
                Math.sin(funStyles.default.dropShadowAngle + Math.PI / 4) * 5 +
                5;
              animated[0].setStyles(funStyles);
              animated[1].setStyleForTag("default", funStyles.default);
            }

            // requestAnimationFrame(animate);
          </script>
        </div>
      </div>
    </main>
  </body>
</html>
